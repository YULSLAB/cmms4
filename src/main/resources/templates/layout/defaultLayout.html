<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{page.title.default}">CMMS Application</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            display: flex;
            min-height: 100vh;
            flex-direction: column;
        }
        .main-container {
            display: flex;
            flex: 1;
        }
        .sidebar {
            width: 250px;
            background-color: #343a40;
            color: white;
            transition: all 0.3s;
            overflow-y: auto;
        }
        .sidebar-collapsed {
            width: 60px;
        }
        .content-wrapper {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        .user-info {
            font-size: 0.9em;
        }
        .logout-form {
            margin-left: 15px;
        }
        .nav-link {
            color: rgba(255,255,255,.75);
            padding: 8px 16px;
        }
        .nav-link:hover {
            color: white;
        }
        .submenu {
            padding-left: 20px;
            display: none;
        }
        .submenu.show {
            display: block;
        }
        .menu-toggle {
            cursor: pointer;
        }
        .menu-icon {
            width: 20px;
            text-align: center;
            margin-right: 8px;
        }
        .sidebar-toggle {
            cursor: pointer;
            padding: 10px;
        }
    </style>
    <!-- 페이지별 CSS -->
    <th:block layout:fragment="page-css"></th:block>
</head>
<body>
    <header class="header">
        <div class="d-flex align-items-center">
            <div class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </div>
            <span class="ms-3 fw-bold">CMMS</span>
        </div>
        <div sec:authorize="isAuthenticated()" class="user-info">
            <span th:text="${session.formattedUserInfo}">User Info Placeholder</span>
            <form th:action="@{/logout}" method="post" style="display: inline;" class="logout-form">
                <button type="submit" class="btn btn-sm btn-outline-secondary" th:text="#{logout.button}">Logout</button>
            </form>
        </div>
    </header>

    <div class="main-container">
        <nav class="sidebar" id="sidebar">
            <div class="pt-3">
                <ul class="nav flex-column">
                    <!-- 메모 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-sticky-note"></i></span>
                            <span class="menu-text">Memo</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/memo/memoForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/memo/memoList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- Inspection 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-clipboard-check"></i></span>
                            <span class="menu-text">Inspection</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/inspection/inspectionForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/inspection/inspectionList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- WorkOrder 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-tasks"></i></span>
                            <span class="menu-text">WorkOrder</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/workorder/workorderForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/workorder/workorderList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- PlantMaster 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-industry"></i></span>
                            <span class="menu-text">PlantMaster</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/plant/plantForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/plant/plantList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- InventoryMaster 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-boxes"></i></span>
                            <span class="menu-text">InventoryMaster</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/inventory/inventoryForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/inventory/inventoryList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- 공통코드 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-code"></i></span>
                            <span class="menu-text">공통코드</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/code/codeForm}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-plus-circle"></i></span>
                                    <span class="menu-text">입력</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/code/codeList}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-list"></i></span>
                                    <span class="menu-text">목록</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    
                    <!-- 설정정보 메뉴 -->
                    <li class="nav-item">
                        <a href="#" class="nav-link menu-toggle">
                            <span class="menu-icon"><i class="fas fa-cogs"></i></span>
                            <span class="menu-text">설정정보</span>
                            <i class="fas fa-chevron-down float-end mt-1"></i>
                        </a>
                        <ul class="submenu nav flex-column">
                            <li class="nav-item">
                                <a th:href="@{/settings/site}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-building"></i></span>
                                    <span class="menu-text">사이트</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/settings/department}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-sitemap"></i></span>
                                    <span class="menu-text">부서</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/settings/user}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-users"></i></span>
                                    <span class="menu-text">사용자</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/settings/role}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-user-tag"></i></span>
                                    <span class="menu-text">Role</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a th:href="@{/settings/siteAccess}" class="nav-link">
                                    <span class="menu-icon"><i class="fas fa-key"></i></span>
                                    <span class="menu-text">SiteAccess</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="content-wrapper">
            <main layout:fragment="content">
                <!-- 페이지별 콘텐츠가 여기에 삽입됩니다 -->
                <p>This is default content from layout.html. If you see this, the page did not provide its own content fragment.</p>
            </main>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // 메뉴 토글 기능
            $('.menu-toggle').click(function(e) {
                e.preventDefault();
                $(this).next('.submenu').toggleClass('show');
                $(this).find('.fa-chevron-down').toggleClass('fa-chevron-up');
            });
            
            // 사이드바 토글 기능
            $('#sidebarToggle').click(function() {
                $('#sidebar').toggleClass('sidebar-collapsed');
                if ($('#sidebar').hasClass('sidebar-collapsed')) {
                    $('.menu-text').hide();
                    $('.submenu').removeClass('show');
                    $('.fa-chevron-down, .fa-chevron-up').hide();
                } else {
                    $('.menu-text').show();
                    $('.fa-chevron-down, .fa-chevron-up').show();
                }
            });
        });
    </script>
    
    <!-- 페이지별 JS -->
    <th:block layout:fragment="page-js"></th:block>
</body>
</html>